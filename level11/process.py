#! /usr/bin/python

import sys

def decrypt(bytes, length):
    key = length & 0xff   

    for i in range(0, length):
        oldbyte = bytes[i]
        bytes[i] = bytes[i] ^ key
        key = (key - oldbyte) & 0xFFFFFFFF

    return ''.join([chr(byte) for byte in bytes])

def encrypt(bytes, length):
    key = length & 0xff   

    for i in range(0, length):
        bytes[i] = bytes[i] ^ key
        key = (key - bytes[i]) & 0xFFFFFFFF

    return bytes

if len(sys.argv) != 2:
    print("Need a string to process")
    sys.exit(1)
    
bytes = [ord(x) for x in sys.argv[1]]
length = len(bytes)

print("Encrypted bytes:")
print(encrypt(bytes, length))

print("Decrypted string:")
print(decrypt(bytes, length))
